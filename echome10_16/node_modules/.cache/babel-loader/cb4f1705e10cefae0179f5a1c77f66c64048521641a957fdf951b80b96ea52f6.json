{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport * as moment from \"moment\";\nimport XLSX from 'xlsx';\nexport const mixins = {\n  data() {\n    return {\n      res: 1,\n      dateChose: []\n    };\n  },\n  computed: {\n    community_id() {\n      if (this.$store.getters.getPostInfo.community_list != undefined) {\n        return this.$store.getters.getPostInfo.community_list[0].community_id;\n      } else {\n        return \"1\";\n      }\n    }\n  },\n  methods: {\n    //building\n    //builduingType\n    buildingType(item) {\n      let res = {};\n      switch (item) {\n        case 1:\n          res = {\n            value: \"住宅\",\n            color: \"red\"\n          };\n          break;\n        case 2:\n          res = {\n            value: \"车位\",\n            color: \"blue\"\n          };\n          break;\n        case 3:\n          res = {\n            value: \"仓房\",\n            color: \"pink\"\n          };\n          break;\n        case 4:\n          res = {\n            value: \"商户\",\n            color: \"skyblue\"\n          };\n          break;\n        case 5:\n          res = {\n            value: \"车库\",\n            color: \"orange\"\n          };\n          break;\n      }\n      return res;\n    },\n    //detail\n    detailInfo(item) {\n      let types = this.buildingType(item.type);\n      let res = (item.area ? item.area : \"\") + \" \" + (item.building ? item.building : \"\") + \" \" + (item.unit ? item.unit : \"\") + \" \" + item.number + (types.value ? types.value : \"\");\n      return res;\n    },\n    //全屏\n    screenfullEnter() {\n      const el = document.documentElement;\n      const eventEnter = el.requestFullscreen || el.webkitRequestFullScreen || el.mozRequestFullScreen || el.msRequestFullScreen;\n      if (typeof eventEnter !== \"undefined\" && eventEnter) {\n        eventEnter.call(el);\n      }\n    },\n    //退出全屏\n    screenfullOut() {\n      let eventOut = document.cancelFullScreen || document.webkitCancelFullScreen || document.mozCancelFullScreen || document.msExitFullScreen;\n      if (typeof eventOut !== \"undefined\" && eventOut) {\n        eventOut.call(document);\n      }\n    },\n    //检测是否全屏\n    checkFull() {\n      let isFullScreen = document.fullscreenElement || document.mozFullScreenElement || document.webkitFullScreenElement || document.msFullscreenElement;\n      if (isFullScreen === undefined) isFullScreen = false;\n      return isFullScreen;\n    },\n    //获取当天0点的时间戳，以及这一周的日期信息\n    getDayInfo() {\n      var initTime = new Date(new Date().setHours(0, 0, 0, 0)).getTime();\n      var bound = 24 * 60 * 60 * 1000;\n      for (let i = 0; i < 7; i++) {\n        let item = moment(initTime + bound * i).format(\"YYYY-M-D-d\").split(\"-\");\n        let arr = [\"星期天\", \"星期一\", \"星期二\", \"星期三\", \"星期四\", \"星期五\", \"星期六\"];\n        let items = {\n          year: item[0],\n          month: item[1],\n          day: item[2],\n          week: arr[item[3]]\n        };\n        this.dateChose.push(items);\n      }\n    },\n    //文件上传部分\n    readExcel(file) {\n      let _this = this;\n      return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onload = e => {\n          try {\n            // 以二进制流方式读取得到整份excel表格对象\n            var data = e.target.result,\n              workbook = XLSX.read(data, {\n                type: 'binary'\n              });\n          } catch (e) {\n            reject(e.message);\n          } // 表格的表格范围，可用于判断表头是否数量是否正确\n          var fromTo = '';\n          // 遍历每张表读取\n          for (var sheet in workbook.Sheets) {\n            let sheetInfos = workbook.Sheets[sheet];\n            let locations = []; // A1,B1,C1...\n            if (workbook.Sheets.hasOwnProperty(sheet)) {\n              fromTo = sheetInfos['!ref']; // A1:B5\n              locations = _this.getLocationsKeys(fromTo);\n            }\n            for (let i = 0; i < locations.length; i++) {\n              let value = sheetInfos[locations[i]].v;\n              if (value != i) {\n                // 自定的校验规则，自由实现即可\n                // 校验失败reject\n                reject(locations[i] + '\\'s parameter isn\\'t ' + i);\n              }\n            }\n            // 校验成功resolve\n            resolve(true);\n          }\n        };\n        reader.readAsBinaryString(file);\n      });\n    }\n  }\n};","map":{"version":3,"names":["moment","XLSX","mixins","data","res","dateChose","computed","community_id","$store","getters","getPostInfo","community_list","undefined","methods","buildingType","item","value","color","detailInfo","types","type","area","building","unit","number","screenfullEnter","el","document","documentElement","eventEnter","requestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullScreen","call","screenfullOut","eventOut","cancelFullScreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullScreen","checkFull","isFullScreen","fullscreenElement","mozFullScreenElement","webkitFullScreenElement","msFullscreenElement","getDayInfo","initTime","Date","setHours","getTime","bound","i","format","split","arr","items","year","month","day","week","push","readExcel","file","_this","Promise","resolve","reject","reader","FileReader","onload","e","target","result","workbook","read","message","fromTo","sheet","Sheets","sheetInfos","locations","hasOwnProperty","getLocationsKeys","length","v","readAsBinaryString"],"sources":["D:/前端/e家项目仿照/echome3_16/echome3_16/src/minxin/index.js"],"sourcesContent":["import * as moment from \"moment\";\r\nimport XLSX from 'xlsx'\r\nexport const mixins = {\r\n  data() {\r\n    return {\r\n      res: 1,\r\n      dateChose: [],\r\n    };\r\n  },\r\n  computed: {\r\n    community_id() {\r\n      if (this.$store.getters.getPostInfo.community_list != undefined) {\r\n        return this.$store.getters.getPostInfo.community_list[0].community_id;\r\n      } else {\r\n        return \"1\";\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n\r\n    //building\r\n    //builduingType\r\n    buildingType(item) {\r\n      let res = {};\r\n      switch (item) {\r\n        case 1:\r\n          res = { value: \"住宅\", color: \"red\" };\r\n          break;\r\n        case 2:\r\n          res = { value: \"车位\", color: \"blue\" };\r\n          break;\r\n        case 3:\r\n          res = { value: \"仓房\", color: \"pink\" };\r\n          break;\r\n        case 4:\r\n          res = { value: \"商户\", color: \"skyblue\" };\r\n          break;\r\n        case 5:\r\n          res = { value: \"车库\", color: \"orange\" };\r\n          break;\r\n      }\r\n      return res;\r\n    },\r\n    //detail\r\n    detailInfo(item) {\r\n      let types = this.buildingType(item.type);\r\n      let res =\r\n        (item.area ? item.area : \"\") +\r\n        \" \" +\r\n        (item.building ? item.building : \"\") +\r\n        \" \" +\r\n        (item.unit ? item.unit : \"\") +\r\n        \" \" +\r\n        item.number +\r\n        (types.value ? types.value : \"\");\r\n      return res;\r\n    },\r\n    //全屏\r\n    screenfullEnter() {\r\n      const el = document.documentElement;\r\n      const eventEnter =\r\n        el.requestFullscreen ||\r\n        el.webkitRequestFullScreen ||\r\n        el.mozRequestFullScreen ||\r\n        el.msRequestFullScreen;\r\n      if (typeof eventEnter !== \"undefined\" && eventEnter) {\r\n        eventEnter.call(el);\r\n      }\r\n    },\r\n    //退出全屏\r\n    screenfullOut() {\r\n      let eventOut =\r\n        document.cancelFullScreen ||\r\n        document.webkitCancelFullScreen ||\r\n        document.mozCancelFullScreen ||\r\n        document.msExitFullScreen;\r\n      if (typeof eventOut !== \"undefined\" && eventOut) {\r\n        eventOut.call(document);\r\n      }\r\n    },\r\n    //检测是否全屏\r\n    checkFull() {\r\n      let isFullScreen =\r\n        document.fullscreenElement ||\r\n        document.mozFullScreenElement ||\r\n        document.webkitFullScreenElement ||\r\n        document.msFullscreenElement;\r\n      if (isFullScreen === undefined) isFullScreen = false;\r\n      return isFullScreen;\r\n    },\r\n\r\n    //获取当天0点的时间戳，以及这一周的日期信息\r\n    getDayInfo() {\r\n      var initTime = new Date(new Date().setHours(0, 0, 0, 0)).getTime();\r\n      var bound = 24 * 60 * 60 * 1000;\r\n      for (let i = 0; i < 7; i++) {\r\n        let item = moment(initTime + bound * i)\r\n          .format(\"YYYY-M-D-d\")\r\n          .split(\"-\");\r\n        let arr = [\r\n          \"星期天\",\r\n          \"星期一\",\r\n          \"星期二\",\r\n          \"星期三\",\r\n          \"星期四\",\r\n          \"星期五\",\r\n          \"星期六\",\r\n        ];\r\n        let items = {\r\n          year: item[0],\r\n          month: item[1],\r\n          day: item[2],\r\n          week: arr[item[3]],\r\n        };\r\n        this.dateChose.push(items);\r\n      }\r\n    },\r\n\r\n\t//文件上传部分\r\n\treadExcel(file){\r\n\t\tlet _this=this\r\n\t\treturn new Promise((resolve,reject)=>{\r\n\t\t\tconst reader=new FileReader()\r\nreader.onload=(e)=>{\r\n\ttry {\r\n\t\t// 以二进制流方式读取得到整份excel表格对象\r\n\t\tvar data = e.target.result, workbook = XLSX.read(data, {type: 'binary'});\r\n\t  } catch (e) {\r\n\t\treject(e.message);\r\n\t  }       // 表格的表格范围，可用于判断表头是否数量是否正确\r\n\t  var fromTo = '';\r\n\t  // 遍历每张表读取\r\n\t  for (var sheet in workbook.Sheets) {\r\n\t\tlet sheetInfos = workbook.Sheets[sheet];\r\n\t\tlet locations = [];// A1,B1,C1...\r\n\t\tif (workbook.Sheets.hasOwnProperty(sheet)) {\r\n\t\t  fromTo = sheetInfos['!ref'];// A1:B5\r\n\t\t  locations = _this.getLocationsKeys(fromTo);\r\n\t\t}         for (let i = 0;i < locations.length; i++) {\r\n\t\t  let value = sheetInfos[locations[i]].v;\r\n\t\t  if (value != i) {// 自定的校验规则，自由实现即可\r\n\t\t\t// 校验失败reject\r\n\t\t\treject(locations[i] + '\\'s parameter isn\\'t ' + i);\r\n\t\t  }\r\n\t\t}\r\n\t\t// 校验成功resolve\r\n\t\tresolve(true);\r\n\t  }\r\n}\r\nreader.readAsBinaryString(file);\r\n\r\n\t\t})\r\n\t}\r\n  },\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}