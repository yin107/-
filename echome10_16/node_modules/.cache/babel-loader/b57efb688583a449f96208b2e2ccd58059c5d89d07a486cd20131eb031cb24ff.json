{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport formFinish from \"@/components/formFinish.vue\";\nexport default {\n  components: {\n    formFinish\n  },\n  data() {\n    return {\n      usermessForm: {\n        formName: \"usermessForm\",\n        FormRes: {\n          real_name: \"尹采云\",\n          idcard: \"430525199902093329\",\n          avatar_url: undefined,\n          phone: \"18397681878\",\n          account: \"红薯粉丝\",\n          password: \"w12345678\",\n          password2: \"w12345678\"\n        },\n        FormData: {\n          Info: [{\n            label: \"姓名\",\n            prop: \"real_name\",\n            type: \"input\"\n          }, {\n            label: \"身份证号\",\n            prop: \"idcard\",\n            type: \"input\"\n          }, {\n            label: \"手机号码\",\n            prop: \"phone\",\n            type: \"input\"\n          }, {\n            label: \"登录账号\",\n            prop: \"account\",\n            type: \"input\"\n          }, {\n            label: \"登录密码\",\n            prop: \"password\",\n            type: \"input\",\n            ispass: true\n          }, {\n            label: \"确认登录密码\",\n            prop: \"password2\",\n            type: \"input\",\n            ispass: true\n          }],\n          Rules: {\n            real_name: [{\n              required: true,\n              message: \"请输入您的真实姓名\"\n            }, {\n              max: 8,\n              message: \"姓名不能超过8个字符\"\n            }],\n            idcard: [{\n              required: true,\n              message: \"请输入您的身份证号码\"\n            }, {\n              pattern: /^\\d{17}\\d|x$/i,\n              message: \"请输入正确的身份证号码\"\n            }],\n            phone: [{\n              required: true,\n              message: \"请输入您的手机号码\"\n            }, {\n              pattern: /^\\d{11}$/,\n              message: \"请输入正确的手机号码\"\n            }],\n            account: [{\n              required: true,\n              message: \"请输入账号\"\n            }, {\n              min: 4,\n              message: \"账号的长度应该大于4个字符\"\n            }],\n            password: [{\n              required: true,\n              message: \"请输入密码\"\n            }, {\n              min: 6,\n              message: \"密码的长度应该大于6个字符\"\n            }],\n            password2: [{\n              required: true,\n              message: \"请确认密码\"\n            }, {\n              min: 6,\n              message: \"密码的长度应该大于6个字符\"\n            }, {\n              validator: (rule, val, cb) => {\n                if (val && this.usermessForm.FormRes.password && val === this.usermessForm.FormRes.password) {\n                  cb();\n                } else {\n                  this.notifyError(\"两次输入的密码不一致\");\n                  new Error(\"两次输入的密码不一致\");\n                }\n              },\n              message: \"两次输入的密码不一致\"\n            }]\n          }\n        }\n      },\n      commuForm: {\n        name: \"cfdfd\",\n        address: \"fddf\",\n        service_phone: \"18397681878\",\n        banner: \"\",\n        access_nfc: 0,\n        access_qrcode: 0,\n        access_remote: 0,\n        fitment_pledge: 0,\n        carport_max_car: 1\n      },\n      commuRules: {\n        name: [{\n          required: true,\n          message: \"请输入小区名称\"\n        }, {\n          max: 12,\n          message: \"小区名称不能超过12个字符\"\n        }],\n        address: [{\n          required: true\n        }],\n        service_phone: [{\n          required: true,\n          message: \"请输入小区客户电话\"\n        }, {\n          pattern: /^\\d{11}$/,\n          message: \"请输入正确的电话号码\"\n        }],\n        access_nfc: [{\n          required: true,\n          type: \"number\"\n        }],\n        access_qrcode: [{\n          required: true,\n          type: \"number\"\n        }],\n        access_remote: [{\n          required: true,\n          type: \"number\"\n        }],\n        fitment_pledge: [{\n          required: true,\n          type: \"number\"\n        }],\n        carport_max_car: [{\n          required: true,\n          pattern: /^\\d+$/,\n          message: \"请输入正确的车位可绑定车辆的数目\"\n        }]\n      }\n    };\n  },\n  mounted() {\n    console.log(this.$ress['usermessForm']);\n  },\n  methods: {\n    checkForm(forName) {\n      return new Promise((resolve, reject) => {\n        this.$refs[forName].validate(valid => {\n          if (valid) {\n            resolve();\n          } else {\n            reject(\"请输入正确的信息\");\n          }\n        });\n      });\n    },\n    regester() {\n      // 先对两个form表单进行验证\n      Promise.all([this.checkForm(\"usermessForm\"), this.checkForm(\"commuForm\")]).then(() => {\n        //表单验证成功的话，就发送请求\n        const {\n          code,\n          state\n        } = this.$route.query;\n        const obj2 = {\n          province: \"湖南省\",\n          city: \"邵阳市\",\n          district: \"洞口\",\n          code,\n          state,\n          open_id: 1\n        };\n        const data = Object.assign(this.usermessForm.FormRes, this.commuForm, obj2);\n        delete data.address;\n        this.$mylocalrequest({\n          url: \"/init/run\",\n          method: \"post\",\n          data: data\n        }).then(() => {\n          //注册成功之后就跳转到登录页\n          this.$router.push({\n            path: \"/user/login\"\n          });\n        }).catch(err => {\n          this.notifyError(err);\n        });\n      }).catch(err => {\n        this.notifyError(err);\n      });\n    }\n  },\n  name: \"indexVue\"\n};","map":{"version":3,"names":["formFinish","components","data","usermessForm","formName","FormRes","real_name","idcard","avatar_url","undefined","phone","account","password","password2","FormData","Info","label","prop","type","ispass","Rules","required","message","max","pattern","min","validator","rule","val","cb","notifyError","Error","commuForm","name","address","service_phone","banner","access_nfc","access_qrcode","access_remote","fitment_pledge","carport_max_car","commuRules","mounted","console","log","$ress","methods","checkForm","forName","Promise","resolve","reject","$refs","validate","valid","regester","all","then","code","state","$route","query","obj2","province","city","district","open_id","Object","assign","$mylocalrequest","url","method","$router","push","path","catch","err"],"sources":["src/views/user/init/index.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"header\">系统初始化信息</div>\r\n    <!-- 信息 -->\r\n    <div class=\"info\">\r\n      <!-- 个人信息 -->\r\n      <el-card class=\"box-card\">\r\n        <div slot=\"header\">\r\n          <span>个人基本资料</span>\r\n        </div>\r\n        <!-- form表单区域 -->\r\n        <form-finish :name=\"usermessForm.formName\" :FormRes.sync=\"usermessForm.FormRes\" :FormData.sync=\"usermessForm.FormData\"></form-finish>\r\n      \r\n      </el-card>\r\n\r\n      <!-- 小区信息 -->\r\n      <el-card class=\"box-card\">\r\n        <div slot=\"header\">\r\n          <span>初始化小区信息</span>\r\n        </div>\r\n        <el-form ref=\"commuForm\" :model=\"commuForm\" :rules=\"commuRules\" inline>\r\n          <el-form-item label=\"小区名称\" prop=\"name\">\r\n            <el-input v-model=\"commuForm.name\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"小区所在地\" prop=\"address\">\r\n            <el-input v-model=\"commuForm.address\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"客服电话\" prop=\"service_phone\">\r\n            <el-input v-model=\"commuForm.service_phone\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"NFC门禁\" prop=\"access_nfc\">\r\n            <el-switch\r\n              v-model=\"commuForm.access_nfc\"\r\n              active-color=\"#13ce66\"\r\n              inactive-color=\"#ff4949\"\r\n              :active-value=\"1\"\r\n              :inactive-value=\"0\"\r\n            >\r\n            </el-switch>\r\n          </el-form-item>\r\n          <el-form-item label=\"二维码门禁\" prop=\"access_qrcode\">\r\n            <el-switch\r\n              v-model=\"commuForm.access_qrcode\"\r\n              active-color=\"#13ce66\"\r\n              inactive-color=\"#ff4949\"\r\n              :active-value=\"1\"\r\n              :inactive-value=\"0\"\r\n            >\r\n            </el-switch>\r\n          </el-form-item>\r\n          <el-form-item label=\"远程开门\" prop=\"access_remote\">\r\n            <el-switch\r\n              v-model=\"commuForm.access_remote\"\r\n              active-color=\"#13ce66\"\r\n              inactive-color=\"#ff4949\"\r\n              :active-value=\"1\"\r\n              :inactive-value=\"0\"\r\n            >\r\n            </el-switch>\r\n          </el-form-item>\r\n          <el-form-item label=\"装修保证金\" prop=\"fitment_pledge\">\r\n            <el-switch\r\n              v-model=\"commuForm.fitment_pledge\"\r\n              active-color=\"#13ce66\"\r\n              inactive-color=\"#ff4949\"\r\n              :active-value=\"1\"\r\n              :inactive-value=\"0\"\r\n            >\r\n            </el-switch>\r\n          </el-form-item>\r\n          <el-form-item label=\"车位绑定车辆数\" prop=\"carport_max_car\">\r\n            <el-input-number\r\n              v-model=\"commuForm.carport_max_car\"\r\n              controls-position=\"right\"\r\n              :min=\"1\"\r\n            ></el-input-number>\r\n          </el-form-item>\r\n        </el-form>\r\n      </el-card>\r\n    </div>\r\n    <el-button @click=\"$router.push({ name: 'login' })\">返回登录页</el-button>\r\n    <el-button @click=\"regester()\" type=\"primary\">注册</el-button>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport formFinish from \"@/components/formFinish.vue\";\r\nexport default {\r\n  components: { formFinish },\r\n  data() {\r\n    return {\r\n      usermessForm: {\r\n\t\tformName:\"usermessForm\",\r\n        FormRes: {\r\n        real_name: \"尹采云\",\r\n        idcard: \"430525199902093329\",\r\n        avatar_url: undefined,\r\n        phone: \"18397681878\",\r\n        account: \"红薯粉丝\",\r\n        password: \"w12345678\",\r\n        password2: \"w12345678\",\r\n      },\r\n      FormData: {\r\n        Info: [\r\n          {\r\n            label: \"姓名\",\r\n            prop: \"real_name\",\r\n            type: \"input\",\r\n          },\r\n          {\r\n            label: \"身份证号\",\r\n            prop: \"idcard\",\r\n            type: \"input\",\r\n          },\r\n          {\r\n            label: \"手机号码\",\r\n            prop: \"phone\",\r\n            type: \"input\",\r\n          },\r\n          {\r\n            label: \"登录账号\",\r\n            prop: \"account\",\r\n            type: \"input\",\r\n          },\r\n          {\r\n            label: \"登录密码\",\r\n            prop: \"password\",\r\n            type: \"input\",\r\n            ispass: true,\r\n          },\r\n          {\r\n            label: \"确认登录密码\",\r\n            prop: \"password2\",\r\n            type: \"input\",\r\n            ispass: true,\r\n          },\r\n        ],\r\n        Rules: {\r\n          real_name: [\r\n            { required: true, message: \"请输入您的真实姓名\" },\r\n            { max: 8, message: \"姓名不能超过8个字符\" },\r\n          ],\r\n          idcard: [\r\n            { required: true, message: \"请输入您的身份证号码\" },\r\n            { pattern: /^\\d{17}\\d|x$/i, message: \"请输入正确的身份证号码\" },\r\n          ],\r\n          phone: [\r\n            { required: true, message: \"请输入您的手机号码\" },\r\n            { pattern: /^\\d{11}$/, message: \"请输入正确的手机号码\" },\r\n          ],\r\n          account: [\r\n            { required: true, message: \"请输入账号\" },\r\n            { min: 4, message: \"账号的长度应该大于4个字符\" },\r\n          ],\r\n          password: [\r\n            { required: true, message: \"请输入密码\" },\r\n            { min: 6, message: \"密码的长度应该大于6个字符\" },\r\n          ],\r\n          password2: [\r\n            { required: true, message: \"请确认密码\" },\r\n            { min: 6, message: \"密码的长度应该大于6个字符\" },\r\n            {\r\n              validator: (rule, val, cb) => {\r\n                if (\r\n                  val &&\r\n                  this.usermessForm.FormRes.password &&\r\n                  val === this.usermessForm.FormRes.password\r\n                ) {\r\n                  cb();\r\n                } else {\r\n\t\t\t\t\tthis.notifyError(\"两次输入的密码不一致\");\r\n                  new Error(\"两次输入的密码不一致\");\r\n                }\r\n              },\r\n              message: \"两次输入的密码不一致\",\r\n            },\r\n          ],\r\n        },\r\n      },\r\n      },\r\n\r\n      commuForm: {\r\n        name: \"cfdfd\",\r\n        address: \"fddf\",\r\n        service_phone: \"18397681878\",\r\n        banner: \"\",\r\n        access_nfc: 0,\r\n        access_qrcode: 0,\r\n        access_remote: 0,\r\n        fitment_pledge: 0,\r\n        carport_max_car: 1,\r\n      },\r\n      commuRules: {\r\n        name: [\r\n          { required: true, message: \"请输入小区名称\" },\r\n          { max: 12, message: \"小区名称不能超过12个字符\" },\r\n        ],\r\n        address: [{ required: true }],\r\n        service_phone: [\r\n          { required: true, message: \"请输入小区客户电话\" },\r\n          { pattern: /^\\d{11}$/, message: \"请输入正确的电话号码\" },\r\n        ],\r\n        access_nfc: [{ required: true, type: \"number\" }],\r\n        access_qrcode: [{ required: true, type: \"number\" }],\r\n        access_remote: [{ required: true, type: \"number\" }],\r\n        fitment_pledge: [{ required: true, type: \"number\" }],\r\n        carport_max_car: [\r\n          {\r\n            required: true,\r\n            pattern: /^\\d+$/,\r\n            message: \"请输入正确的车位可绑定车辆的数目\",\r\n          },\r\n        ],\r\n      },\r\n    };\r\n  },\r\n  mounted(){\r\n\tconsole.log(this.$ress['usermessForm']);\r\n  },\r\n  methods: {\r\n    checkForm(forName) {\r\n      return new Promise((resolve, reject) => {\r\n        this.$refs[forName].validate((valid) => {\r\n          if (valid) {\r\n            resolve();\r\n          } else {\r\n            reject(\"请输入正确的信息\");\r\n          }\r\n        });\r\n      });\r\n    },\r\n    regester() {\r\n      // 先对两个form表单进行验证\r\n      Promise.all([this.checkForm(\"usermessForm\"), this.checkForm(\"commuForm\")])\r\n        .then(() => {\r\n          //表单验证成功的话，就发送请求\r\n          const { code, state } = this.$route.query;\r\n          const obj2 = {\r\n            province: \"湖南省\",\r\n            city: \"邵阳市\",\r\n            district: \"洞口\",\r\n            code,\r\n            state,\r\n            open_id: 1,\r\n          };\r\n          const data = Object.assign(this.usermessForm.FormRes, this.commuForm, obj2);\r\n\r\n          delete data.address;\r\n          this.$mylocalrequest({\r\n            url: \"/init/run\",\r\n            method: \"post\",\r\n            data: data,\r\n          })\r\n            .then(() => {\r\n              //注册成功之后就跳转到登录页\r\n              this.$router.push({ path: \"/user/login\" });\r\n            })\r\n            .catch((err) => {\r\n              this.notifyError(err);\r\n            });\r\n        })\r\n        .catch((err) => {\r\n          this.notifyError(err);\r\n        });\r\n    },\r\n  },\r\n  name: \"indexVue\",\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.header {\r\n  width: 100vw;\r\n  height: 80px;\r\n  line-height: 80px;\r\n  font-size: 25px;\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n  background-color: #fff;\r\n}\r\n.box-card {\r\n  width: 90%;\r\n  margin: 20px auto;\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}