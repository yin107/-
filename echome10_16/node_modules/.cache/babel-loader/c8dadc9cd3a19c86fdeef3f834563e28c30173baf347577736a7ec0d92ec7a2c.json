{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport breadCrumb from \"components/breadCrumb\";\nexport default {\n  components: {\n    breadCrumb\n  },\n  name: \"detailVue\",\n  mounted() {\n    this.getData();\n  },\n  data() {\n    return {\n      petInfo: {},\n      vacciInfo: [],\n      updateInfo: false,\n      updateform: {\n        pet_license: \"\",\n        pet_license_award_at: \"\"\n      },\n      updaterules: {\n        pet_license: [{\n          required: true\n        }],\n        pet_license_award_at: [{\n          required: true\n        }]\n      },\n      columns: [{\n        prop: \"vaccinated_at\",\n        label: \"接种时间\"\n      }, {\n        prop: \"vaccine_type\",\n        label: \"接种类型\"\n      }],\n      updatevacciform: {\n        vaccinated_at: \"\",\n        vaccine_type: \"\"\n      },\n      updatevacci: false,\n      updatevaccirules: {\n        vaccinated_at: [{\n          required: true\n        }],\n        vaccine_type: [{\n          required: true\n        }]\n      }\n    };\n  },\n  methods: {\n    //获取数据\n    getData() {\n      this.$request({\n        url: \"/pet/detail\",\n        method: \"post\",\n        data: {\n          community_id: this.community_id,\n          id: this.petId\n        }\n      }).then(res => {\n        console.log(res);\n        this.petInfo = res.data.data.info;\n        this.vacciInfo = res.data.data.vaccinates;\n        this.vacciInfo = this.vacciInfo.map(item => {\n          item.vaccinated_at = this.standDate(item.vaccinated_at);\n          return item;\n        });\n      });\n    },\n    //更新宠物信息\n    updatePetInfo() {\n      ///先验证表单\n      this.$refs[\"updateform\"].validate(valid => {\n        if (valid) {\n          //向后端发送请求\n          this.$request({\n            url: `/pet/license/${this.petId}`,\n            method: \"post\",\n            data: {\n              community_id: this.community_id,\n              ...this.updateform\n            }\n          }).then(res => {\n            this.petInfo.pet_license = this.updateform.pet_license;\n            this.petInfo.pet_license_award_at = this.updateform.pet_license_award_at;\n            this.updateInfo = false;\n          });\n        }\n      });\n    },\n    //添加疫苗信息\n    updatevacciconfirm() {\n      this.$refs[\"updatevacciform\"].validate(valid => {\n        if (valid) {\n          this.vacciInfo.push([this.updatevacciform]);\n          this.updatevacci = false;\n        }\n      });\n    }\n  },\n  computed: {\n    community_id() {\n      if (this.$store.getters.getPostInfo.community_list != undefined) {\n        return this.$store.getters.getPostInfo.community_list[0].community_id;\n      } else {\n        return \"1\";\n      }\n    },\n    petId() {\n      return this.$route.query.id;\n    }\n  }\n};","map":{"version":3,"names":["breadCrumb","components","name","mounted","getData","data","petInfo","vacciInfo","updateInfo","updateform","pet_license","pet_license_award_at","updaterules","required","columns","prop","label","updatevacciform","vaccinated_at","vaccine_type","updatevacci","updatevaccirules","methods","$request","url","method","community_id","id","petId","then","res","console","log","info","vaccinates","map","item","standDate","updatePetInfo","$refs","validate","valid","updatevacciconfirm","push","computed","$store","getters","getPostInfo","community_list","undefined","$route","query"],"sources":["src/views/basic/pet/detail.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <bread-crumb>\r\n      <span slot=\"goback\" style=\"float: right\" @click=\"$router.go(-1)\">\r\n        返回</span\r\n      >\r\n    </bread-crumb>\r\n    <!-- 宠物信息 -->\r\n    <el-card class=\"box-card\">\r\n      <div slot=\"header\" class=\"clearfix\">\r\n        <span>宠物信息</span>\r\n        <span style=\"color: blueviolet\" @click=\"updateInfo = true\"\r\n          >更新登记证</span\r\n        >\r\n      </div>\r\n      <div class=\"content\">\r\n        <el-row>\r\n          <el-col :span=\"8\">宠物名称：{{ petInfo.name }}</el-col>\r\n          <el-col :span=\"8\">宠物类型：{{ petInfo.pet_type }}</el-col>\r\n          <el-col :span=\"8\">宠物品种：{{ petInfo.breed }}</el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"8\">宠物毛色：{{ petInfo.coat_color }}</el-col>\r\n          <el-col :span=\"8\">小区名称：{{ petInfo.community_name }}</el-col>\r\n          <el-col :span=\"8\"\r\n            >宠物登记：<el-tag\r\n              :type=\"petInfo.pet_license ? 'success' : 'info'\"\r\n              >{{ petInfo.pet_license ? \"已登记\" : \"未登记\" }}</el-tag\r\n            ></el-col\r\n          >\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"8\">证书编号：{{ petInfo.pet_license }}</el-col>\r\n          <el-col :span=\"8\"\r\n            >发证日期：{{ petInfo.pet_license_award_at }}</el-col\r\n          >\r\n          <el-col :span=\"8\">主人信息：{{ petInfo.wechat_mp_user_id }}</el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"8\"\r\n            >宠物照片：<img :src=\"petInfo.photo\" alt=\"\" width=\"80\" height=\"80\"\r\n          /></el-col>\r\n          <el-col :span=\"8\"\r\n            >是否注销：<el-tag :type=\"petInfo.remove ? 'success' : 'info'\">{{\r\n              petInfo.remove ? \"是\" : \"否\"\r\n            }}</el-tag></el-col\r\n          >\r\n        </el-row>\r\n      </div>\r\n    </el-card>\r\n    <!-- 更新宠物登记信息 -->\r\n    <el-dialog :visible.sync=\"updateInfo\">\r\n      <span slot=\"title\">更新宠物登记证</span>\r\n      <el-form ref=\"updateform\" :model=\"updateform\" :rules=\"updaterules\">\r\n        <el-form-item prop=\"pet_license\" label=\"证书编号\">\r\n          <el-input\r\n            v-model=\"updateform.pet_license\"\r\n            placeholder=\"请输入登记编号\"\r\n          ></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"pet_license_award_at\" label=\"发证日期\">\r\n          <el-date-picker\r\n            v-model=\"updateform.pet_license_award_at\"\r\n            type=\"date\"\r\n            placeholder=\"选择日期\"\r\n            format=\"yyyy年MM月dd日\"\r\n            value-format=\"timestamp\"\r\n            style=\"width: 300px; float: left\"\r\n          ></el-date-picker>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\">\r\n        <el-button @click=\"updateInfo = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"updatePetInfo\">更新</el-button>\r\n      </span>\r\n    </el-dialog>\r\n\r\n    <!-- 一疫苗接种历史 -->\r\n    <el-card class=\"box-card\">\r\n      <div slot=\"header\" class=\"clearfix\">\r\n        <span>疫苗接种历史</span>\r\n        <span style=\"color: blueviolet\" @click=\"updatevacci = true\">添加</span>\r\n      </div>\r\n      <el-table :data=\"vacciInfo\">\r\n        <el-table-column\r\n          v-for=\"item of columns\"\r\n          :key=\"item.prop\"\r\n          :prop=\"item.prop\"\r\n          :label=\"item.label\"\r\n        ></el-table-column>\r\n      </el-table>\r\n    </el-card>\r\n\r\n    <!-- 添加疫苗信息 -->\r\n    <el-dialog :visible.sync=\"updatevacci\">\r\n      <span slot=\"title\">疫苗接种信息</span>\r\n      <el-form\r\n        ref=\"updatevacciform\"\r\n        :model=\"updatevacciform\"\r\n        :rules=\"updatevaccirules\"\r\n      >\r\n        <el-form-item prop=\"vaccine_type\" label=\"疫苗类型\">\r\n          <el-input\r\n            v-model=\"updatevacciform.vaccine_type\"\r\n            placeholder=\"请输入疫苗类型\"\r\n          ></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"vaccinated_at\" label=\"接种日期\">\r\n          <el-date-picker\r\n            v-model=\"updatevacciform.vaccinated_at\"\r\n            type=\"date\"\r\n            placeholder=\"选择接种日期\"\r\n            format=\"yyyy年MM月dd日\"\r\n            value-format=\"timestamp\"\r\n            style=\"width: 300px; float: left\"\r\n          ></el-date-picker>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\">\r\n        <el-button @click=\"updatevacci = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"updatevacciconfirm\">确定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport breadCrumb from \"components/breadCrumb\";\r\nexport default {\r\n  components: { breadCrumb },\r\n  name: \"detailVue\",\r\n  mounted() {\r\n    this.getData();\r\n  },\r\n  data() {\r\n    return {\r\n      petInfo: {},\r\n      vacciInfo: [],\r\n      updateInfo: false,\r\n      updateform: {\r\n        pet_license: \"\",\r\n        pet_license_award_at: \"\",\r\n      },\r\n      updaterules: {\r\n        pet_license: [{ required: true }],\r\n        pet_license_award_at: [{ required: true }],\r\n      },\r\n      columns: [\r\n        { prop: \"vaccinated_at\", label: \"接种时间\" },\r\n        { prop: \"vaccine_type\", label: \"接种类型\" },\r\n      ],\r\n      updatevacciform: {\r\n        vaccinated_at: \"\",\r\n        vaccine_type: \"\",\r\n      },\r\n      updatevacci: false,\r\n      updatevaccirules: {\r\n        vaccinated_at: [{ required: true }],\r\n        vaccine_type: [{ required: true }],\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    //获取数据\r\n    getData() {\r\n      this.$request({\r\n        url: \"/pet/detail\",\r\n        method: \"post\",\r\n        data: {\r\n          community_id: this.community_id,\r\n          id: this.petId,\r\n        },\r\n      }).then((res) => {\r\n        console.log(res);\r\n        this.petInfo = res.data.data.info;\r\n        this.vacciInfo = res.data.data.vaccinates;\r\n        this.vacciInfo = this.vacciInfo.map((item) => {\r\n          item.vaccinated_at = this.standDate(item.vaccinated_at);\r\n          return item;\r\n        });\r\n      });\r\n    },\r\n    //更新宠物信息\r\n    updatePetInfo() {\r\n      ///先验证表单\r\n      this.$refs[\"updateform\"].validate((valid) => {\r\n        if (valid) {\r\n          //向后端发送请求\r\n          this.$request({\r\n            url: `/pet/license/${this.petId}`,\r\n            method: \"post\",\r\n            data: {\r\n              community_id: this.community_id,\r\n              ...this.updateform,\r\n            },\r\n          }).then((res) => {\r\n            this.petInfo.pet_license = this.updateform.pet_license;\r\n            this.petInfo.pet_license_award_at =\r\n              this.updateform.pet_license_award_at;\r\n            this.updateInfo = false;\r\n          });\r\n        }\r\n      });\r\n    },\r\n    //添加疫苗信息\r\n    updatevacciconfirm() {\r\n      this.$refs[\"updatevacciform\"].validate((valid) => {\r\n        if (valid) {\r\n          this.vacciInfo.push([this.updatevacciform]);\r\n          this.updatevacci = false;\r\n        }\r\n      });\r\n    },\r\n  },\r\n  computed: {\r\n    community_id() {\r\n      if (this.$store.getters.getPostInfo.community_list != undefined) {\r\n        return this.$store.getters.getPostInfo.community_list[0].community_id;\r\n      } else {\r\n        return \"1\";\r\n      }\r\n    },\r\n    petId() {\r\n      return this.$route.query.id;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.box-card {\r\n  margin-top: 20px;\r\n}\r\n.clearfix {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n.content {\r\n  font-size: 15px;\r\n}\r\n.content img {\r\n  vertical-align: middle;\r\n}\r\n</style>\r\n"],"mappings":";AA+HA,OAAAA,UAAA;AACA;EACAC,UAAA;IAAAD;EAAA;EACAE,IAAA;EACAC,QAAA;IACA,KAAAC,OAAA;EACA;EACAC,KAAA;IACA;MACAC,OAAA;MACAC,SAAA;MACAC,UAAA;MACAC,UAAA;QACAC,WAAA;QACAC,oBAAA;MACA;MACAC,WAAA;QACAF,WAAA;UAAAG,QAAA;QAAA;QACAF,oBAAA;UAAAE,QAAA;QAAA;MACA;MACAC,OAAA,GACA;QAAAC,IAAA;QAAAC,KAAA;MAAA,GACA;QAAAD,IAAA;QAAAC,KAAA;MAAA,EACA;MACAC,eAAA;QACAC,aAAA;QACAC,YAAA;MACA;MACAC,WAAA;MACAC,gBAAA;QACAH,aAAA;UAAAL,QAAA;QAAA;QACAM,YAAA;UAAAN,QAAA;QAAA;MACA;IACA;EACA;EACAS,OAAA;IACA;IACAlB,QAAA;MACA,KAAAmB,QAAA;QACAC,GAAA;QACAC,MAAA;QACApB,IAAA;UACAqB,YAAA,OAAAA,YAAA;UACAC,EAAA,OAAAC;QACA;MACA,GAAAC,IAAA,CAAAC,GAAA;QACAC,OAAA,CAAAC,GAAA,CAAAF,GAAA;QACA,KAAAxB,OAAA,GAAAwB,GAAA,CAAAzB,IAAA,CAAAA,IAAA,CAAA4B,IAAA;QACA,KAAA1B,SAAA,GAAAuB,GAAA,CAAAzB,IAAA,CAAAA,IAAA,CAAA6B,UAAA;QACA,KAAA3B,SAAA,QAAAA,SAAA,CAAA4B,GAAA,CAAAC,IAAA;UACAA,IAAA,CAAAlB,aAAA,QAAAmB,SAAA,CAAAD,IAAA,CAAAlB,aAAA;UACA,OAAAkB,IAAA;QACA;MACA;IACA;IACA;IACAE,cAAA;MACA;MACA,KAAAC,KAAA,eAAAC,QAAA,CAAAC,KAAA;QACA,IAAAA,KAAA;UACA;UACA,KAAAlB,QAAA;YACAC,GAAA,uBAAAI,KAAA;YACAH,MAAA;YACApB,IAAA;cACAqB,YAAA,OAAAA,YAAA;cACA,QAAAjB;YACA;UACA,GAAAoB,IAAA,CAAAC,GAAA;YACA,KAAAxB,OAAA,CAAAI,WAAA,QAAAD,UAAA,CAAAC,WAAA;YACA,KAAAJ,OAAA,CAAAK,oBAAA,GACA,KAAAF,UAAA,CAAAE,oBAAA;YACA,KAAAH,UAAA;UACA;QACA;MACA;IACA;IACA;IACAkC,mBAAA;MACA,KAAAH,KAAA,oBAAAC,QAAA,CAAAC,KAAA;QACA,IAAAA,KAAA;UACA,KAAAlC,SAAA,CAAAoC,IAAA,OAAA1B,eAAA;UACA,KAAAG,WAAA;QACA;MACA;IACA;EACA;EACAwB,QAAA;IACAlB,aAAA;MACA,SAAAmB,MAAA,CAAAC,OAAA,CAAAC,WAAA,CAAAC,cAAA,IAAAC,SAAA;QACA,YAAAJ,MAAA,CAAAC,OAAA,CAAAC,WAAA,CAAAC,cAAA,IAAAtB,YAAA;MACA;QACA;MACA;IACA;IACAE,MAAA;MACA,YAAAsB,MAAA,CAAAC,KAAA,CAAAxB,EAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}